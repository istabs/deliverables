<!doctype html>
<html lang=pt>

<head>
	<meta charset="utf-8">
	<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

	<title>IST delivery schedule</title>
	<meta name="description" content="IST deliverables">
	<meta name="author" content="ABS">

	<!-- IMPORTS -->
	<link rel="shortcut icon" type="image/x-icon" href="favicon.ico">
	<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/4.4.1/css/bootstrap.min.css">
	<link href="https://cdnjs.cloudflare.com/ajax/libs/tabulator/4.4.3/css/tabulator.min.css" rel="stylesheet">
	<link href="https://istabs.github.io/deliverables/deliverables_style.css" rel="stylesheet">
	<script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.js"></script>
	<script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/4.4.1/js/bootstrap.bundle.min.js"></script>
	<script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/sprintf/1.1.2/sprintf.min.js"></script>
	<script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/tabulator/4.4.3/js/tabulator.min.js"></script>
	<script type="text/javascript" src="https://istabs.github.io/deliverables/date_extensions.js"></script>
	<script type="text/javascript" src="https://istabs.github.io/deliverables/deliverables_support.js"></script>
</head>

<body>
	<div class="container-fluid">
		<h1>IST/MEIC ABS delivery schedule</h1>
		<div id="dropScheduleHere"></div>
	</div>

	<script>
		var getDataFilename = () => {
			var today = new Date();
			var year = today.getFullYear();
			var month = today.getMonth();
			var semester = month > 1 && month < 6 ? 2 : 1;
			var lectiveYear = year - (semester == 1 && month > 8 ? 1 : 0);
			return '' + lectiveYear + '_' + semester + ".json";
		}
	</script>
	<script>
		fetch(getDataFilename()).then((response) => response.json()).then((json) => {
			var tabulator = new Tabulator("#dropScheduleHere", {
				layout: "fitDataFill",
				data: extractData(json),
				tooltips: false,
				movableColumns: true,
				responsiveLayout: "hide",
				height: 560,
				initialSort: [{
					column: "timer",
					dir: "asc"
				}],
				columns: [
					{ title: "UC", field: "uc", width: 60, headerFilter: true, },
					{ title: "Deliverable", field: "deliverable", },
					{ title: "Deliverable Type", field: "type", width: 112, },
					{ title: "Due date", field: "dueDate", },
					{ title: "Days left", field: "days", align: "right", width: 75, },
					{ title: "Timer", field: "timer", minWidth: 280, formatter: "progress", align: "right", },
				],
			});
		});
	</script>
</body>

</html>